<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fauna del Valle del Cauca - Explorador de Biodiversidad</title>
    
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Font Awesome para iconos -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">
    
    <!-- Animate.css para animaciones -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    
    <!-- AOS para animaciones al hacer scroll -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    
    <!-- Leaflet para mapas -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <!-- Leaflet MarkerCluster -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css" />
    
    <style>
        :root {
            --primary-color: #2e7d32;
            --secondary-color: #4caf50;
            --accent-color: #8bc34a;
            --dark-color: #1b5e20;
            --light-color: #e8f5e9;
            --text-color: #333;
            --text-light: #666;
            --gradient-primary: linear-gradient(135deg, #2e7d32 0%, #4caf50 100%);
            --gradient-secondary: linear-gradient(135deg, #4caf50 0%, #8bc34a 100%);
            --shadow-light: 0 5px 15px rgba(0,0,0,0.05);
            --shadow-medium: 0 10px 25px rgba(0,0,0,0.1);
            --shadow-heavy: 0 15px 35px rgba(0,0,0,0.15);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Roboto', sans-serif;
            color: var(--text-color);
            background-color: #f9f9f9;
            line-height: 1.6;
            overflow-x: hidden;
        }
        
        h1, h2, h3, h4, h5, h6 {
            font-family: 'Poppins', sans-serif;
            font-weight: 600;
        }
        
        /* Navbar mejorada */
        .navbar {
            background: var(--gradient-primary);
            box-shadow: var(--shadow-medium);
            padding: 0.8rem 0;
            transition: all 0.3s ease;
        }
        
        .navbar.scrolled {
            padding: 0.5rem 0;
            background: rgba(46, 125, 50, 0.95);
            backdrop-filter: blur(10px);
        }
        
        .navbar-brand {
            font-weight: 700;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
        }
        
        .navbar-brand i {
            margin-right: 10px;
            font-size: 1.8rem;
        }
        
        .nav-link {
            font-weight: 500;
            margin: 0 5px;
            border-radius: 5px;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .nav-link:hover, .nav-link.active {
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        .nav-link::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            width: 0;
            height: 2px;
            background: white;
            transition: all 0.3s ease;
            transform: translateX(-50%);
        }
        
        .nav-link:hover::after, .nav-link.active::after {
            width: 80%;
        }
        
        /* Hero Section mejorada */
        .hero-section {
            background: linear-gradient(rgba(0,0,0,0.7), rgba(0,0,0,0.7)), url('https://images.unsplash.com/photo-1544551763-46a013bb70d5?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80') no-repeat center center;
            background-size: cover;
            background-attachment: fixed;
            color: white;
            padding: 150px 0 100px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .hero-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--gradient-primary);
            opacity: 0.3;
            z-index: 1;
        }
        
        .hero-section > .container {
            position: relative;
            z-index: 2;
        }
        
        .hero-section h1 {
            font-size: 3.5rem;
            margin-bottom: 1.5rem;
            text-shadow: 2px 2px 8px rgba(0,0,0,0.5);
        }
        
        .hero-section p {
            font-size: 1.3rem;
            max-width: 800px;
            margin: 0 auto 2.5rem;
            opacity: 0.9;
        }
        
        .search-container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .search-box {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            box-shadow: var(--shadow-medium);
        }
        
        .section-title {
            text-align: center;
            margin-bottom: 3rem;
            position: relative;
        }
        
        .section-title:after {
            content: '';
            display: block;
            width: 80px;
            height: 4px;
            background: var(--gradient-secondary);
            margin: 15px auto;
            border-radius: 2px;
        }
        
        /* Cards mejoradas */
        .card {
            border: none;
            border-radius: 15px;
            box-shadow: var(--shadow-light);
            transition: all 0.4s ease;
            margin-bottom: 25px;
            overflow: hidden;
            background: white;
        }
        
        .card:hover {
            transform: translateY(-10px);
            box-shadow: var(--shadow-heavy);
        }
        
        .card-img-top {
            height: 220px;
            object-fit: cover;
            transition: transform 0.5s ease;
        }
        
        .card:hover .card-img-top {
            transform: scale(1.05);
        }
        
        .species-icon {
            font-size: 2.2rem;
            margin-bottom: 15px;
            color: var(--primary-color);
        }
        
        /* Stats Cards mejoradas */
        .stats-card {
            text-align: center;
            padding: 30px 20px;
            border-radius: 15px;
            background: white;
            box-shadow: var(--shadow-light);
            transition: all 0.3s ease;
            border-top: 4px solid var(--primary-color);
        }
        
        .stats-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-medium);
        }
        
        .stats-number {
            font-size: 2.8rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 5px;
        }
        
        .stats-label {
            font-size: 1rem;
            color: var(--text-light);
            font-weight: 500;
        }
        
        /* Categorías mejoradas */
        .category-badge {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
            margin-right: 5px;
            margin-bottom: 5px;
            transition: all 0.3s ease;
        }
        
        .category-badge:hover {
            transform: scale(1.05);
        }
        
        .mammal { background-color: #e3f2fd; color: #1565c0; }
        .bird { background-color: #e8f5e9; color: #2e7d32; }
        .reptile { background-color: #f3e5f5; color: #7b1fa2; }
        .amphibian { background-color: #fff3e0; color: #ef6c00; }
        .fish { background-color: #e0f2f1; color: #00695c; }
        .insect { background-color: #fff9c4; color: #f57f17; }
        .plant { background-color: #e8f5e9; color: #1b5e20; }
        .fungi { background-color: #fce4ec; color: #c2185b; }
        .other { background-color: #f5f5f5; color: #424242; }
        
        /* Mapa mejorado */
        #map {
            height: 500px;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: var(--shadow-light);
        }
        
        .map-controls {
            position: absolute;
            top: 15px;
            right: 15px;
            z-index: 1000;
            background: white;
            padding: 10px;
            border-radius: 10px;
            box-shadow: var(--shadow-medium);
        }
        
        .map-legend {
            position: absolute;
            bottom: 20px;
            right: 15px;
            z-index: 1000;
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: var(--shadow-medium);
            max-width: 220px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            margin-right: 10px;
        }
        
        /* Loading mejorado */
        .loading-spinner {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 200px;
        }
        
        /* Sección de herramientas mejorada */
        .tools-section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: var(--shadow-light);
            margin-bottom: 30px;
            transition: all 0.3s ease;
        }
        
        .tools-section:hover {
            box-shadow: var(--shadow-medium);
        }
        
        .tool-card {
            text-align: center;
            padding: 30px 20px;
            border-radius: 15px;
            background: white;
            box-shadow: var(--shadow-light);
            transition: all 0.4s ease;
            height: 100%;
            border: 1px solid rgba(0,0,0,0.05);
        }
        
        .tool-card:hover {
            background: var(--gradient-primary);
            color: white;
            transform: translateY(-10px);
            box-shadow: var(--shadow-heavy);
        }
        
        .tool-icon {
            font-size: 3rem;
            margin-bottom: 20px;
            color: var(--primary-color);
            transition: all 0.3s ease;
        }
        
        .tool-card:hover .tool-icon {
            color: white;
            transform: scale(1.1);
        }
        
        /* Modal mejorado */
        .species-detail-modal img {
            max-width: 100%;
            border-radius: 10px;
            box-shadow: var(--shadow-light);
        }
        
        .modal-header {
            background: var(--gradient-primary);
            color: white;
            border-bottom: none;
            border-radius: 15px 15px 0 0;
        }
        
        .modal-content {
            border-radius: 15px;
            border: none;
            box-shadow: var(--shadow-heavy);
        }
        
        /* Gráficos mejorados */
        .chart-container {
            position: relative;
            height: 300px;
            margin-bottom: 30px;
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: var(--shadow-light);
        }
        
        /* Filtros de timeline mejorados */
        .timeline-filter {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: var(--shadow-light);
            margin-bottom: 20px;
        }
        
        /* Botones mejorados */
        .btn {
            border-radius: 8px;
            font-weight: 500;
            padding: 10px 20px;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        
        .btn-primary {
            background: var(--gradient-primary);
            border: none;
        }
        
        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-medium);
        }
        
        .btn-outline-primary {
            color: var(--primary-color);
            border-color: var(--primary-color);
        }
        
        .btn-outline-primary:hover {
            background: var(--gradient-primary);
            border-color: transparent;
            transform: translateY(-3px);
        }
        
        .btn-light {
            background: rgba(255, 255, 255, 0.9);
            color: var(--text-color);
        }
        
        .btn-light:hover {
            background: white;
            transform: translateY(-3px);
        }
        
        /* Footer mejorado */
        footer {
            background: var(--dark-color);
            color: white;
            padding: 60px 0 20px;
            position: relative;
        }
        
        footer::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: var(--gradient-secondary);
        }
        
        .footer-links a {
            color: #ccc;
            text-decoration: none;
            display: block;
            margin-bottom: 10px;
            transition: all 0.3s ease;
            position: relative;
            padding-left: 15px;
        }
        
        .footer-links a::before {
            content: '›';
            position: absolute;
            left: 0;
            transition: all 0.3s ease;
        }
        
        .footer-links a:hover {
            color: white;
            transform: translateX(5px);
        }
        
        .copyright {
            border-top: 1px solid rgba(255,255,255,0.1);
            padding-top: 20px;
            margin-top: 40px;
            text-align: center;
            color: #aaa;
            font-size: 0.9rem;
        }
        
        .social-links a {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            margin-right: 10px;
            transition: all 0.3s ease;
        }
        
        .social-links a:hover {
            background: var(--accent-color);
            transform: translateY(-3px);
        }
        
        /* Animaciones personalizadas */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .fade-in-up {
            animation: fadeInUp 0.6s ease forwards;
        }
        
        /* Efectos de partículas para el hero */
        .particles {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }
        
        .particle {
            position: absolute;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 50%;
            animation: float 15s infinite linear;
        }
        
        @keyframes float {
            0% {
                transform: translateY(0) translateX(0) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-1000%) translateX(1000%) rotate(720deg);
                opacity: 0;
            }
        }
        
        /* Responsive mejorado */
        @media (max-width: 768px) {
            .hero-section {
                padding: 120px 0 80px;
            }
            
            .hero-section h1 {
                font-size: 2.5rem;
            }
            
            .hero-section p {
                font-size: 1.1rem;
            }
            
            .map-controls, .map-legend {
                position: relative;
                top: auto;
                right: auto;
                margin-bottom: 15px;
            }
            
            .stats-number {
                font-size: 2.2rem;
            }
        }
        
        @media (max-width: 576px) {
            .hero-section h1 {
                font-size: 2rem;
            }
            
            .search-box {
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container">
            <a class="navbar-brand" href="#">
                <i class="fas fa-leaf"></i>Fauna Valle del Cauca
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="#inicio">Inicio</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#especies">Especies</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#observaciones">Observaciones</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#proyectos">Proyectos</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#personas">Personas</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#mapa">Mapa Interactivo</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#herramientas">Herramientas</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#estadisticas">Estadísticas</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#amenazas">Amenazas</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#acerca">Acerca de</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section id="inicio" class="hero-section">
        <div class="particles" id="particles-js"></div>
        <div class="container">
            <h1 class="animate__animated animate__fadeInDown">Explora la Fauna del Valle del Cauca</h1>
            <p class="animate__animated animate__fadeInUp">Descubre la increíble biodiversidad de nuestra región. Observa, aprende y contribuye al conocimiento de nuestras especies.</p>
            
            <div class="search-container animate__animated animate__fadeInUp">
                <div class="search-box">
                    <div class="input-group input-group-lg mb-3">
                        <input type="text" id="searchInput" class="form-control" placeholder="Buscar especies, lugares, observadores...">
                        <button class="btn btn-light" type="button" id="searchButton">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                    <div class="d-flex flex-wrap justify-content-center">
                        <button class="btn btn-outline-light me-2 mb-2" data-category="mammal">
                            <i class="fas fa-paw me-1"></i>Mamíferos
                        </button>
                        <button class="btn btn-outline-light me-2 mb-2" data-category="bird">
                            <i class="fas fa-dove me-1"></i>Aves
                        </button>
                        <button class="btn btn-outline-light me-2 mb-2" data-category="reptile">
                            <i class="fas fa-staff-snake me-1"></i>Reptiles
                        </button>
                        <button class="btn btn-outline-light me-2 mb-2" data-category="amphibian">
                            <i class="fas fa-frog me-1"></i>Anfibios
                        </button>
                        <button class="btn btn-outline-light me-2 mb-2" data-category="insect">
                            <i class="fas fa-bug me-1"></i>Insectos
                        </button>
                        <button class="btn btn-outline-light mb-2" data-category="plant">
                            <i class="fas fa-seedling me-1"></i>Plantas
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Estadísticas -->
    <section id="estadisticas" class="py-5 bg-light">
        <div class="container">
            <h2 class="section-title">Estadísticas de Biodiversidad</h2>
            <div class="row text-center">
                <div class="col-md-3 mb-4">
                    <div class="stats-card fade-in-up" data-aos="fade-up">
                        <div class="stats-number" id="totalSpecies">0</div>
                        <div class="stats-label">Especies Totales</div>
                    </div>
                </div>
                <div class="col-md-3 mb-4">
                    <div class="stats-card fade-in-up" data-aos="fade-up" data-aos-delay="100">
                        <div class="stats-number" id="totalObservations">0</div>
                        <div class="stats-label">Observaciones</div>
                    </div>
                </div>
                <div class="col-md-3 mb-4">
                    <div class="stats-card fade-in-up" data-aos="fade-up" data-aos-delay="200">
                        <div class="stats-number" id="totalObservers">0</div>
                        <div class="stats-label">Observadores</div>
                    </div>
                </div>
                <div class="col-md-3 mb-4">
                    <div class="stats-card fade-in-up" data-aos="fade-up" data-aos-delay="300">
                        <div class="stats-number" id="endangeredSpecies">0</div>
                        <div class="stats-label">Especies Amenazadas</div>
                    </div>
                </div>
            </div>
            <div class="row mt-4">
                <div class="col-md-6">
                    <div class="chart-container" data-aos="fade-right">
                        <canvas id="categoryChart"></canvas>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="chart-container" data-aos="fade-left">
                        <canvas id="monthlyChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Especies Destacadas -->
    <section id="especies" class="py-5">
        <div class="container">
            <h2 class="section-title">Especies Destacadas</h2>
            <div class="row" id="featuredSpecies">
                <!-- Las especies se cargarán aquí dinámicamente -->
                <div class="col-12 text-center">
                    <div class="loading-spinner">
                        <div class="spinner-border text-primary" role="status">
                            <span class="visually-hidden">Cargando...</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="text-center mt-4">
                <button class="btn btn-outline-primary" id="loadMoreSpecies">
                    <i class="fas fa-plus me-2"></i>Cargar Más Especies
                </button>
            </div>
        </div>
    </section>

    <!-- Mapa de Observaciones -->
    <section id="mapa" class="py-5 bg-light">
        <div class="container">
            <h2 class="section-title">Observaciones en el Valle del Cauca</h2>
            
            <div class="row mb-4">
                <div class="col-md-6">
                    <div class="timeline-filter" data-aos="fade-right">
                        <h5>Filtrar por fecha</h5>
                        <div class="row">
                            <div class="col-md-6">
                                <label for="startDate" class="form-label">Desde</label>
                                <input type="date" class="form-control" id="startDate">
                            </div>
                            <div class="col-md-6">
                                <label for="endDate" class="form-label">Hasta</label>
                                <input type="date" class="form-control" id="endDate">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="timeline-filter" data-aos="fade-left">
                        <h5>Filtrar por categoría</h5>
                        <select class="form-select" id="categoryFilter">
                            <option value="all">Todas las categorías</option>
                            <option value="mammal">Mamíferos</option>
                            <option value="bird">Aves</option>
                            <option value="reptile">Reptiles</option>
                            <option value="amphibian">Anfibios</option>
                            <option value="insect">Insectos</option>
                            <option value="plant">Plantas</option>
                            <option value="fungi">Hongos</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <div class="position-relative" data-aos="zoom-in">
                <div id="map"></div>
                <div class="map-controls">
                    <div class="btn-group-vertical">
                        <button class="btn btn-sm btn-light mb-1" id="zoomIn">
                            <i class="fas fa-plus"></i>
                        </button>
                        <button class="btn btn-sm btn-light" id="zoomOut">
                            <i class="fas fa-minus"></i>
                        </button>
                    </div>
                </div>
                <div class="map-legend">
                    <h6>Leyenda</h6>
                    <div class="legend-item">
                        <div class="legend-color mammal"></div>
                        <span>Mamíferos</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color bird"></div>
                        <span>Aves</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color reptile"></div>
                        <span>Reptiles</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color amphibian"></div>
                        <span>Anfibios</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color insect"></div>
                        <span>Insectos</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color plant"></div>
                        <span>Plantas</span>
                    </div>
                </div>
            </div>
            
            <div class="text-center mt-4">
                <button class="btn btn-primary me-2" id="refreshMap">
                    <i class="fas fa-sync-alt me-2"></i>Actualizar Mapa
                </button>
                <button class="btn btn-outline-primary" id="downloadData">
                    <i class="fas fa-download me-2"></i>Descargar Datos
                </button>
            </div>
        </div>
    </section>

    <!-- Observaciones Recientes -->
    <section id="observaciones" class="py-5">
        <div class="container">
            <h2 class="section-title">Observaciones Recientes</h2>
            <div id="recentObservations">
                <!-- Las observaciones se cargarán aquí dinámicamente -->
                <div class="col-12 text-center">
                    <div class="loading-spinner">
                        <div class="spinner-border text-primary" role="status">
                            <span class="visually-hidden">Cargando...</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="text-center mt-4">
                <button class="btn btn-outline-primary" id="loadMoreObservations">
                    <i class="fas fa-plus me-2"></i>Cargar Más Observaciones
                </button>
            </div>
        </div>
    </section>

    <!-- Proyectos -->
    <section id="proyectos" class="py-5 bg-light">
        <div class="container">
            <h2 class="section-title">Proyectos de Conservación</h2>
            <div class="row">
                <div class="col-md-4 mb-4" data-aos="fade-up">
                    <div class="card h-100">
                        <div class="card-body">
                            <h5 class="card-title">Monitoreo de Aves Migratorias</h5>
                            <p class="card-text">Seguimiento de las poblaciones de aves migratorias que visitan el Valle del Cauca durante sus rutas estacionales.</p>
                            <div class="d-flex justify-content-between align-items-center">
                                <span class="badge bg-success">Activo</span>
                                <span class="text-muted">Desde 2018</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4 mb-4" data-aos="fade-up" data-aos-delay="100">
                    <div class="card h-100">
                        <div class="card-body">
                            <h5 class="card-title">Conservación de Anfibios</h5>
                            <p class="card-text">Proyecto enfocado en la protección de especies de anfibios endémicos y en peligro de extinción.</p>
                            <div class="d-flex justify-content-between align-items-center">
                                <span class="badge bg-success">Activo</span>
                                <span class="text-muted">Desde 2020</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4 mb-4" data-aos="fade-up" data-aos-delay="200">
                    <div class="card h-100">
                        <div class="card-body">
                            <h5 class="card-title">Reforestación Participativa</h5>
                            <p class="card-text">Iniciativa comunitaria para restaurar hábitats críticos con especies nativas del Valle del Cauca.</p>
                            <div class="d-flex justify-content-between align-items-center">
                                <span class="badge bg-warning">En planeación</span>
                                <span class="text-muted">Inicia 2024</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Personas -->
    <section id="personas" class="py-5">
        <div class="container">
            <h2 class="section-title">Observadores Destacados</h2>
            <div class="row">
                <div class="col-md-4 mb-4" data-aos="fade-up">
                    <div class="card text-center">
                        <div class="card-body">
                            <img src="https://randomuser.me/api/portraits/men/32.jpg" class="rounded-circle mb-3" alt="Observador" width="100">
                            <h5 class="card-title">Carlos Rodríguez</h5>
                            <p class="card-text text-muted">Especialista en aves</p>
                            <p class="card-text">Más de 1,200 observaciones registradas en la región.</p>
                            <div class="d-flex justify-content-center">
                                <span class="badge bg-primary me-2">Aves</span>
                                <span class="badge bg-success">Mamíferos</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4 mb-4" data-aos="fade-up" data-aos-delay="100">
                    <div class="card text-center">
                        <div class="card-body">
                            <img src="https://randomuser.me/api/portraits/women/44.jpg" class="rounded-circle mb-3" alt="Observadora" width="100">
                            <h5 class="card-title">María González</h5>
                            <p class="card-text text-muted">Botánica aficionada</p>
                            <p class="card-text">Más de 800 observaciones de flora nativa documentadas.</p>
                            <div class="d-flex justify-content-center">
                                <span class="badge bg-success">Plantas</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4 mb-4" data-aos="fade-up" data-aos-delay="200">
                    <div class="card text-center">
                        <div class="card-body">
                            <img src="https://randomuser.me/api/portraits/men/22.jpg" class="rounded-circle mb-3" alt="Observador" width="100">
                            <h5 class="card-title">Javier López</h5>
                            <p class="card-text text-muted">Entomólogo</p>
                            <p class="card-text">Especializado en insectos polinizadores del Valle del Cauca.</p>
                            <div class="d-flex justify-content-center">
                                <span class="badge bg-warning">Insectos</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Amenazas -->
    <section id="amenazas" class="py-5 bg-light">
        <div class="container">
            <h2 class="section-title">Amenazas a la Biodiversidad</h2>
            <div class="row">
                <div class="col-md-6 mb-4" data-aos="fade-right">
                    <div class="card h-100">
                        <div class="card-body">
                            <h5 class="card-title">Pérdida de Hábitat</h5>
                            <p class="card-text">La expansión urbana y agrícola está reduciendo los espacios naturales disponibles para la fauna local.</p>
                            <div class="progress mb-3">
                                <div class="progress-bar bg-danger" role="progressbar" style="width: 75%" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100">Alta</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-6 mb-4" data-aos="fade-left">
                    <div class="card h-100">
                        <div class="card-body">
                            <h5 class="card-title">Cambio Climático</h5>
                            <p class="card-text">Las alteraciones en los patrones climáticos afectan los ciclos de vida de muchas especies.</p>
                            <div class="progress mb-3">
                                <div class="progress-bar bg-warning" role="progressbar" style="width: 60%" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100">Media</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-6 mb-4" data-aos="fade-right">
                    <div class="card h-100">
                        <div class="card-body">
                            <h5 class="card-title">Especies Invasoras</h5>
                            <p class="card-text">La introducción de especies no nativas compite con la fauna local por recursos.</p>
                            <div class="progress mb-3">
                                <div class="progress-bar bg-info" role="progressbar" style="width: 45%" aria-valuenow="45" aria-valuemin="0" aria-valuemax="100">Moderada</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-6 mb-4" data-aos="fade-left">
                    <div class="card h-100">
                        <div class="card-body">
                            <h5 class="card-title">Contaminación</h5>
                            <p class="card-text">La contaminación de suelos y cuerpos de agua afecta directamente a los ecosistemas.</p>
                            <div class="progress mb-3">
                                <div class="progress-bar bg-primary" role="progressbar" style="width: 55%" aria-valuenow="55" aria-valuemin="0" aria-valuemax="100">Media</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Herramientas de Análisis -->
    <section id="herramientas" class="py-5">
        <div class="container">
            <h2 class="section-title">Herramientas de Análisis</h2>
            <div class="row">
                <div class="col-md-4 mb-4" data-aos="fade-up">
                    <div class="tool-card">
                        <i class="fas fa-chart-bar tool-icon"></i>
                        <h5>Análisis de Tendencias</h5>
                        <p>Visualiza cómo cambian las observaciones a lo largo del tiempo</p>
                    </div>
                </div>
                <div class="col-md-4 mb-4" data-aos="fade-up" data-aos-delay="100">
                    <div class="tool-card">
                        <i class="fas fa-map-marked-alt tool-icon"></i>
                        <h5>Mapas de Densidad</h5>
                        <p>Identifica áreas con mayor concentración de especies</p>
                    </div>
                </div>
                <div class="col-md-4 mb-4" data-aos="fade-up" data-aos-delay="200">
                    <div class="tool-card">
                        <i class="fas fa-project-diagram tool-icon"></i>
                        <h5>Relaciones entre Especies</h5>
                        <p>Descubre qué especies suelen observarse juntas</p>
                    </div>
                </div>
                <div class="col-md-4 mb-4" data-aos="fade-up">
                    <div class="tool-card">
                        <i class="fas fa-calendar-alt tool-icon"></i>
                        <h5>Estacionalidad</h5>
                        <p>Analiza patrones estacionales en las observaciones</p>
                    </div>
                </div>
                <div class="col-md-4 mb-4" data-aos="fade-up" data-aos-delay="100">
                    <div class="tool-card">
                        <i class="fas fa-exclamation-triangle tool-icon"></i>
                        <h5>Especies Amenazadas</h5>
                        <p>Identifica y monitorea especies en riesgo</p>
                    </div>
                </div>
                <div class="col-md-4 mb-4" data-aos="fade-up" data-aos-delay="200">
                    <div class="tool-card">
                        <i class="fas fa-download tool-icon"></i>
                        <h5>Exportar Datos</h5>
                        <p>Descarga conjuntos de datos para análisis avanzados</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Acerca de -->
    <section id="acerca" class="py-5 bg-light">
        <div class="container">
            <div class="row">
                <div class="col-lg-6 mb-4" data-aos="fade-right">
                    <h2 class="section-title text-start">Sobre el Proyecto</h2>
                    <p>Esta aplicación web tiene como objetivo mostrar la rica biodiversidad del Valle del Cauca, Colombia, utilizando datos en tiempo real de la plataforma iNaturalist.</p>
                    <p>El Valle del Cauca es una de las regiones con mayor biodiversidad en Colombia, albergando una gran variedad de ecosistemas que van desde las costas del Pacífico hasta las altas montañas de los Andes.</p>
                    <p>Con esta herramienta, puedes explorar especies, ver observaciones recientes en un mapa interactivo y aprender más sobre la fauna de nuestra región.</p>
                    <div class="social-links mt-4">
                        <a href="#"><i class="fab fa-facebook-f"></i></a>
                        <a href="#"><i class="fab fa-twitter"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-youtube"></i></a>
                    </div>
                </div>
                <div class="col-lg-6" data-aos="fade-left">
                    <h3 class="mb-3">Colabora con el Proyecto</h3>
                    <p>¿Te gustaría contribuir con observaciones de fauna del Valle del Cauca?</p>
                    <p>Puedes unirte a la comunidad de iNaturalist y compartir tus observaciones. Los datos que recopiles ayudarán a científicos y conservacionistas a entender y proteger nuestra biodiversidad.</p>
                    <a href="https://www.inaturalist.org" target="_blank" class="btn btn-primary me-2">
                        <i class="fas fa-external-link-alt me-2"></i>Visitar iNaturalist
                    </a>
                    <a href="#" class="btn btn-outline-primary" data-bs-toggle="modal" data-bs-target="#contributeModal">
                        <i class="fas fa-hands-helping me-2"></i>Cómo Contribuir
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-md-4 mb-4">
                    <h5>Fauna Valle del Cauca</h5>
                    <p>Explorando la biodiversidad de nuestra región.</p>
                </div>
                <div class="col-md-4 mb-4">
                    <h5>Enlaces Rápidos</h5>
                    <div class="footer-links">
                        <a href="#inicio">Inicio</a>
                        <a href="#especies">Especies</a>
                        <a href="#observaciones">Observaciones</a>
                        <a href="#proyectos">Proyectos</a>
                        <a href="#personas">Personas</a>
                        <a href="#mapa">Mapa</a>
                        <a href="#herramientas">Herramientas</a>
                        <a href="#estadisticas">Estadísticas</a>
                        <a href="#amenazas">Amenazas</a>
                    </div>
                </div>
                <div class="col-md-4 mb-4">
                    <h5>Contacto</h5>
                    <div class="footer-links">
                        <a href="mailto:info@faunavalledelcauca.com">info@faunavalledelcauca.com</a>
                        <a href="tel:+573001234567">+57 300 123 4567</a>
                        <a href="#">Cali, Valle del Cauca, Colombia</a>
                    </div>
                </div>
            </div>
            <div class="copyright">
                <p>&copy; 2023 Fauna Valle del Cauca. Todos los derechos reservados.</p>
            </div>
        </div>
    </footer>

    <!-- Modal para detalles de especie -->
    <div class="modal fade" id="speciesModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="speciesModalTitle">Detalles de Especie</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body species-detail-modal" id="speciesModalBody">
                    <!-- Contenido cargado dinámicamente -->
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para contribuir -->
    <div class="modal fade" id="contributeModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Cómo Contribuir al Proyecto</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <p>Hay varias formas en que puedes contribuir a este proyecto:</p>
                    <ul>
                        <li>Regístrate en iNaturalist y comparte tus observaciones</li>
                        <li>Únete a proyectos específicos del Valle del Cauca</li>
                        <li>Ayuda a identificar especies en las observaciones</li>
                        <li>Comparte el proyecto con otros amantes de la naturaleza</li>
                        <li>Reporta especies raras o en peligro</li>
                    </ul>
                    <p>¡Cada observación cuenta para entender y proteger nuestra biodiversidad!</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                    <a href="https://www.inaturalist.org" target="_blank" class="btn btn-primary">Ir a iNaturalist</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    
    <script>
        // Variables globales
        let map;
        let markersCluster;
        let speciesMarkers = [];
        let currentSpeciesPage = 1;
        let currentObservationsPage = 1;
        const resultsPerPage = 12;
        let categoryChart, monthlyChart;

        // Inicialización cuando el DOM esté listo
        document.addEventListener('DOMContentLoaded', function() {
            // Inicializar AOS
            AOS.init({
                duration: 800,
                once: true,
                offset: 100
            });
            
            initMap();
            loadStatistics();
            loadFeaturedSpecies();
            loadRecentObservations();
            initCharts();
            createParticles();
            
            // Configurar eventos
            document.getElementById('searchButton').addEventListener('click', performSearch);
            document.getElementById('searchInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    performSearch();
                }
            });
            
            document.getElementById('refreshMap').addEventListener('click', refreshMapData);
            document.getElementById('downloadData').addEventListener('click', downloadData);
            document.getElementById('loadMoreSpecies').addEventListener('click', loadMoreSpecies);
            document.getElementById('loadMoreObservations').addEventListener('click', loadMoreObservations);
            document.getElementById('zoomIn').addEventListener('click', () => map.zoomIn());
            document.getElementById('zoomOut').addEventListener('click', () => map.zoomOut());
            
            // Configurar filtros
            document.getElementById('categoryFilter').addEventListener('change', applyFilters);
            document.getElementById('startDate').addEventListener('change', applyFilters);
            document.getElementById('endDate').addEventListener('change', applyFilters);
            
            // Configurar botones de categorías
            document.querySelectorAll('[data-category]').forEach(button => {
                button.addEventListener('click', function() {
                    const category = this.getAttribute('data-category');
                    searchByCategory(category);
                });
            });
            
            // Configurar scroll suave para enlaces internos
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href');
                    if (targetId !== '#') {
                        const targetElement = document.querySelector(targetId);
                        if (targetElement) {
                            window.scrollTo({
                                top: targetElement.offsetTop - 80,
                                behavior: 'smooth'
                            });
                        }
                    }
                });
            });
            
            // Configurar navbar scroll effect
            window.addEventListener('scroll', function() {
                if (window.scrollY > 50) {
                    document.querySelector('.navbar').classList.add('scrolled');
                } else {
                    document.querySelector('.navbar').classList.remove('scrolled');
                }
            });
        });

        // Crear partículas para el hero
        function createParticles() {
            const particlesContainer = document.getElementById('particles-js');
            const particleCount = 30;
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.classList.add('particle');
                
                // Tamaño aleatorio
                const size = Math.random() * 5 + 2;
                particle.style.width = `${size}px`;
                particle.style.height = `${size}px`;
                
                // Posición inicial aleatoria
                particle.style.left = `${Math.random() * 100}%`;
                particle.style.top = `${Math.random() * 100}%`;
                
                // Duración de animación aleatoria
                const duration = Math.random() * 20 + 10;
                particle.style.animationDuration = `${duration}s`;
                
                // Retraso aleatorio
                const delay = Math.random() * 5;
                particle.style.animationDelay = `${delay}s`;
                
                particlesContainer.appendChild(particle);
            }
        }

        // Inicializar el mapa
        function initMap() {
            // Coordenadas aproximadas del Valle del Cauca
            const valleDelCaucaCoords = [3.8009, -76.6413];
            
            map = L.map('map').setView(valleDelCaucaCoords, 9);
            
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
            }).addTo(map);
            
            // Inicializar el cluster de marcadores
            markersCluster = L.markerClusterGroup({
                chunkedLoading: true,
                maxClusterRadius: 50
            });
            map.addLayer(markersCluster);
            
            // Agregar un marcador para el Valle del Cauca
            L.marker(valleDelCaucaCoords).addTo(map)
                .bindPopup('Valle del Cauca, Colombia')
                .openPopup();
        }

        // Inicializar gráficos
        function initCharts() {
            const categoryCtx = document.getElementById('categoryChart').getContext('2d');
            const monthlyCtx = document.getElementById('monthlyChart').getContext('2d');
            
            // Datos de ejemplo para los gráficos (en una implementación real, estos vendrían de la API)
            categoryChart = new Chart(categoryCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Aves', 'Insectos', 'Plantas', 'Mamíferos', 'Reptiles', 'Anfibios', 'Hongos'],
                    datasets: [{
                        data: [35, 25, 15, 10, 8, 5, 2],
                        backgroundColor: [
                            '#4caf50', '#fff9c4', '#8bc34a', '#1565c0', '#7b1fa2', '#ef6c00', '#c2185b'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        },
                        title: {
                            display: true,
                            text: 'Observaciones por Categoría'
                        }
                    }
                }
            });
            
            monthlyChart = new Chart(monthlyCtx, {
                type: 'line',
                data: {
                    labels: ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic'],
                    datasets: [{
                        label: 'Observaciones 2023',
                        data: [1200, 1350, 1500, 1800, 2100, 1950, 2200, 2400, 2100, 1900, 1600, 1400],
                        borderColor: '#2e7d32',
                        backgroundColor: 'rgba(46, 125, 50, 0.1)',
                        tension: 0.3,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Observaciones Mensuales'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }

        // Cargar estadísticas
        async function loadStatistics() {
            try {
                // Usar la API de iNaturalist para obtener estadísticas del lugar "Valle del Cauca"
                const response = await fetch('https://api.inaturalist.org/v1/places/autocomplete?q=valle%20del%20cauca');
                const data = await response.json();
                
                if (data.results && data.results.length > 0) {
                    const placeId = data.results[0].id;
                    
                    // Obtener estadísticas del lugar
                    const statsResponse = await fetch(`https://api.inaturalist.org/v1/observations?place_id=${placeId}&verifiable=true&per_page=0`);
                    const statsData = await statsResponse.json();
                    
                    // Actualizar estadísticas en la interfaz
                    document.getElementById('totalObservations').textContent = statsData.total_results.toLocaleString();
                    
                    // Obtener número de especies (aproximado)
                    const speciesResponse = await fetch(`https://api.inaturalist.org/v1/observations/species_counts?place_id=${placeId}&verifiable=true`);
                    const speciesData = await speciesResponse.json();
                    
                    document.getElementById('totalSpecies').textContent = speciesData.total_results.toLocaleString();
                    
                    // Obtener número de observadores
                    const observersResponse = await fetch(`https://api.inaturalist.org/v1/observations/observers?place_id=${placeId}&verifiable=true`);
                    const observersData = await observersResponse.json();
                    
                    document.getElementById('totalObservers').textContent = observersData.total_results.toLocaleString();
                    
                    // Para especies amenazadas, usar un valor aproximado (en una implementación real, se consultaría una API de especies amenazadas)
                    document.getElementById('endangeredSpecies').textContent = Math.floor(speciesData.total_results * 0.05).toLocaleString();
                }
            } catch (error) {
                console.error('Error cargando estadísticas:', error);
                // Valores por defecto en caso de error
                document.getElementById('totalSpecies').textContent = '1,250';
                document.getElementById('totalObservations').textContent = '45,680';
                document.getElementById('totalObservers').textContent = '3,450';
                document.getElementById('endangeredSpecies').textContent = '62';
            }
        }

        // Cargar especies destacadas
        async function loadFeaturedSpecies(page = 1) {
            try {
                const response = await fetch('https://api.inaturalist.org/v1/places/autocomplete?q=valle%20del%20cauca');
                const data = await response.json();
                
                if (data.results && data.results.length > 0) {
                    const placeId = data.results[0].id;
                    
                    // Obtener especies populares del lugar
                    const speciesResponse = await fetch(`https://api.inaturalist.org/v1/observations/species_counts?place_id=${placeId}&verifiable=true&order=desc&order_by=count&per_page=${resultsPerPage}&page=${page}`);
                    const speciesData = await speciesResponse.json();
                    
                    displayFeaturedSpecies(speciesData.results, page);
                }
            } catch (error) {
                console.error('Error cargando especies destacadas:', error);
                // En caso de error, mostrar un mensaje
                document.getElementById('featuredSpecies').innerHTML = `
                    <div class="col-12 text-center">
                        <p>Error cargando especies. Por favor, intenta nuevamente más tarde.</p>
                    </div>
                `;
            }
        }

        // Mostrar especies destacadas en la interfaz
        function displayFeaturedSpecies(species, page = 1) {
            const container = document.getElementById('featuredSpecies');
            
            if (!species || species.length === 0) {
                container.innerHTML = `
                    <div class="col-12 text-center">
                        <p>No se encontraron especies destacadas.</p>
                    </div>
                `;
                return;
            }
            
            let html = page === 1 ? '' : container.innerHTML;
            
            species.forEach(speciesItem => {
                const taxon = speciesItem.taxon;
                const commonName = taxon.preferred_common_name || taxon.name || 'Nombre no disponible';
                const scientificName = taxon.name;
                const observationCount = speciesItem.count;
                const imageUrl = taxon.default_photo ? taxon.default_photo.medium_url : 'https://via.placeholder.com/300x200?text=Imagen+no+disponible';
                const iconClass = getIconForTaxon(taxon);
                const category = getCategoryClass(taxon);
                
                html += `
                    <div class="col-md-4 col-lg-3 mb-4" data-aos="fade-up">
                        <div class="card h-100 species-card" data-species-id="${taxon.id}" data-category="${category}">
                            <img src="${imageUrl}" class="card-img-top" alt="${commonName}">
                            <div class="card-body">
                                <div class="text-center">
                                    <i class="${iconClass} species-icon"></i>
                                </div>
                                <h5 class="card-title">${commonName}</h5>
                                <p class="card-text text-muted"><em>${scientificName}</em></p>
                                <div class="d-flex justify-content-between align-items-center">
                                    <span class="badge bg-primary">${observationCount} observaciones</span>
                                    <span class="category-badge ${category}">${getCategoryName(taxon)}</span>
                                </div>
                            </div>
                            <div class="card-footer bg-transparent">
                                <button class="btn btn-sm btn-outline-primary w-100 view-species-details" data-species-id="${taxon.id}">
                                    <i class="fas fa-info-circle me-1"></i>Ver Detalles
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
            
            // Configurar eventos para los botones de detalles
            document.querySelectorAll('.view-species-details').forEach(button => {
                button.addEventListener('click', function() {
                    const speciesId = this.getAttribute('data-species-id');
                    showSpeciesDetails(speciesId);
                });
            });
        }

        // Cargar más especies
        function loadMoreSpecies() {
            currentSpeciesPage++;
            loadFeaturedSpecies(currentSpeciesPage);
        }

        // Cargar observaciones recientes
        async function loadRecentObservations(page = 1) {
            try {
                const response = await fetch('https://api.inaturalist.org/v1/places/autocomplete?q=valle%20del%20cauca');
                const data = await response.json();
                
                if (data.results && data.results.length > 0) {
                    const placeId = data.results[0].id;
                    
                    // Obtener observaciones recientes
                    const observationsResponse = await fetch(`https://api.inaturalist.org/v1/observations?place_id=${placeId}&verifiable=true&order=desc&order_by=created_at&per_page=${resultsPerPage}&page=${page}`);
                    const observationsData = await observationsResponse.json();
                    
                    displayRecentObservations(observationsData.results, page);
                    updateMapWithObservations(observationsData.results);
                }
            } catch (error) {
                console.error('Error cargando observaciones recientes:', error);
                // En caso de error, mostrar un mensaje
                document.getElementById('recentObservations').innerHTML = `
                    <div class="col-12 text-center">
                        <p>Error cargando observaciones. Por favor, intenta nuevamente más tarde.</p>
                    </div>
                `;
            }
        }

        // Mostrar observaciones recientes en la interfaz
        function displayRecentObservations(observations, page = 1) {
            const container = document.getElementById('recentObservations');
            
            if (!observations || observations.length === 0) {
                container.innerHTML = `
                    <div class="col-12 text-center">
                        <p>No se encontraron observaciones recientes.</p>
                    </div>
                `;
                return;
            }
            
            let html = page === 1 ? '<div class="row">' : container.innerHTML;
            
            observations.forEach(observation => {
                const taxon = observation.taxon;
                const commonName = taxon ? (taxon.preferred_common_name || taxon.name || 'Especie no identificada') : 'Especie no identificada';
                const scientificName = taxon ? taxon.name : 'No identificado';
                const imageUrl = observation.photos && observation.photos.length > 0 ? 
                    observation.photos[0].url.replace('square', 'medium') : 
                    'https://via.placeholder.com/300x200?text=Imagen+no+disponible';
                const observedDate = new Date(observation.observed_on).toLocaleDateString('es-ES');
                const observer = observation.user ? observation.user.login : 'Anónimo';
                const location = observation.place_guess || 'Ubicación no especificada';
                const category = taxon ? getCategoryClass(taxon) : 'other';
                
                html += `
                    <div class="col-md-6 col-lg-4 mb-4" data-aos="fade-up">
                        <div class="card h-100 observation-card" data-observation-id="${observation.id}" data-category="${category}">
                            <img src="${imageUrl}" class="card-img-top" alt="${commonName}">
                            <div class="card-body">
                                <h5 class="card-title">${commonName}</h5>
                                <p class="card-text text-muted"><em>${scientificName}</em></p>
                                <div class="d-flex justify-content-between text-muted small mb-2">
                                    <span><i class="fas fa-calendar-alt me-1"></i> ${observedDate}</span>
                                    <span><i class="fas fa-user me-1"></i> ${observer}</span>
                                </div>
                                <p class="card-text"><i class="fas fa-map-marker-alt me-1"></i> ${location}</p>
                                ${taxon ? `<span class="category-badge ${category}">${getCategoryName(taxon)}</span>` : ''}
                            </div>
                            <div class="card-footer bg-transparent">
                                <button class="btn btn-sm btn-outline-primary view-on-map" data-lat="${observation.geojson ? observation.geojson.coordinates[1] : ''}" data-lng="${observation.geojson ? observation.geojson.coordinates[0] : ''}">
                                    <i class="fas fa-map-marker-alt me-1"></i>Ver en Mapa
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            container.innerHTML = html;
            
            // Configurar eventos para los botones de ver en mapa
            document.querySelectorAll('.view-on-map').forEach(button => {
                button.addEventListener('click', function() {
                    const lat = this.getAttribute('data-lat');
                    const lng = this.getAttribute('data-lng');
                    
                    if (lat && lng) {
                        map.setView([lat, lng], 13);
                        
                        // Desplazar a la sección del mapa
                        document.getElementById('mapa').scrollIntoView({ behavior: 'smooth' });
                    }
                });
            });
        }

        // Cargar más observaciones
        function loadMoreObservations() {
            currentObservationsPage++;
            loadRecentObservations(currentObservationsPage);
        }

        // Actualizar el mapa con observaciones
        function updateMapWithObservations(observations) {
            // Limpiar marcadores anteriores
            markersCluster.clearLayers();
            speciesMarkers = [];
            
            if (!observations || observations.length === 0) return;
            
            observations.forEach(observation => {
                if (observation.geojson && observation.geojson.coordinates) {
                    const lat = observation.geojson.coordinates[1];
                    const lng = observation.geojson.coordinates[0];
                    
                    const taxon = observation.taxon;
                    const commonName = taxon ? (taxon.preferred_common_name || taxon.name) : 'Especie no identificada';
                    const imageUrl = observation.photos && observation.photos.length > 0 ? 
                        observation.photos[0].url.replace('square', 'small') : 
                        'https://via.placeholder.com/75x75?text=Imagen+no+disponible';
                    const category = taxon ? getCategoryClass(taxon) : 'other';
                    const categoryName = taxon ? getCategoryName(taxon) : 'Otro';
                    const observedDate = new Date(observation.observed_on).toLocaleDateString('es-ES');
                    const observer = observation.user ? observation.user.login : 'Anónimo';
                    
                    // Crear icono personalizado basado en la categoría
                    const icon = L.divIcon({
                        className: `custom-marker ${category}`,
                        html: `<i class="${getIconForTaxon(taxon)}"></i>`,
                        iconSize: [30, 30],
                        iconAnchor: [15, 15]
                    });
                    
                    const marker = L.marker([lat, lng], { icon: icon });
                    
                    let popupContent = `
                        <div class="map-popup">
                            <img src="${imageUrl}" alt="${commonName}" style="width: 75px; height: 75px; object-fit: cover; float: left; margin-right: 10px;">
                            <div>
                                <strong>${commonName}</strong><br>
                                ${taxon ? `<em>${taxon.name}</em><br>` : ''}
                                <span class="category-badge ${category}">${categoryName}</span><br>
                                <small>Observado: ${observedDate}</small><br>
                                <small>Por: ${observer}</small>
                            </div>
                            <div style="clear: both; margin-top: 10px;">
                                <button class="btn btn-sm btn-primary view-species-details" data-species-id="${taxon ? taxon.id : ''}" style="width: 100%;">
                                    <i class="fas fa-info-circle me-1"></i>Ver Detalles
                                </button>
                            </div>
                        </div>
                    `;
                    
                    marker.bindPopup(popupContent);
                    markersCluster.addLayer(marker);
                    speciesMarkers.push(marker);
                    
                    // Configurar evento para el botón dentro del popup
                    marker.on('popupopen', function() {
                        document.querySelector('.view-species-details').addEventListener('click', function() {
                            const speciesId = this.getAttribute('data-species-id');
                            if (speciesId) {
                                showSpeciesDetails(speciesId);
                            }
                        });
                    });
                }
            });
            
            // Ajustar el mapa para mostrar todos los marcadores
            if (speciesMarkers.length > 0) {
                const group = new L.featureGroup(speciesMarkers);
                map.fitBounds(group.getBounds().pad(0.1));
            }
        }

        // Mostrar detalles de especie en un modal
        async function showSpeciesDetails(speciesId) {
            try {
                const response = await fetch(`https://api.inaturalist.org/v1/taxa/${speciesId}`);
                const data = await response.json();
                
                if (data.results && data.results.length > 0) {
                    const taxon = data.results[0];
                    const commonName = taxon.preferred_common_name || taxon.name;
                    const scientificName = taxon.name;
                    const imageUrl = taxon.default_photo ? taxon.default_photo.medium_url : 'https://via.placeholder.com/300x200?text=Imagen+no+disponible';
                    const description = taxon.wikipedia_summary || 'No hay descripción disponible.';
                    const conservationStatus = taxon.conservation_status ? taxon.conservation_status.status : 'No evaluada';
                    
                    let html = `
                        <div class="row">
                            <div class="col-md-5">
                                <img src="${imageUrl}" class="img-fluid rounded" alt="${commonName}">
                            </div>
                            <div class="col-md-7">
                                <h4>${commonName}</h4>
                                <p class="text-muted"><em>${scientificName}</em></p>
                                <p><strong>Estado de conservación:</strong> ${conservationStatus}</p>
                                <p><strong>Categoría:</strong> <span class="category-badge ${getCategoryClass(taxon)}">${getCategoryName(taxon)}</span></p>
                                <hr>
                                <h5>Descripción</h5>
                                <p>${description}</p>
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="col-12">
                                <h5>Observaciones Relacionadas</h5>
                                <div id="relatedObservations" class="mt-2">
                                    <div class="text-center">
                                        <div class="spinner-border text-primary" role="status">
                                            <span class="visually-hidden">Cargando...</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    
                    document.getElementById('speciesModalTitle').textContent = commonName;
                    document.getElementById('speciesModalBody').innerHTML = html;
                    
                    // Cargar observaciones relacionadas
                    loadRelatedObservations(speciesId);
                    
                    // Mostrar el modal
                    const speciesModal = new bootstrap.Modal(document.getElementById('speciesModal'));
                    speciesModal.show();
                }
            } catch (error) {
                console.error('Error cargando detalles de especie:', error);
                document.getElementById('speciesModalBody').innerHTML = '<p>Error cargando detalles de la especie.</p>';
            }
        }

        // Cargar observaciones relacionadas con una especie
        async function loadRelatedObservations(speciesId) {
            try {
                const response = await fetch('https://api.inaturalist.org/v1/places/autocomplete?q=valle%20del%20cauca');
                const data = await response.json();
                
                if (data.results && data.results.length > 0) {
                    const placeId = data.results[0].id;
                    
                    const obsResponse = await fetch(`https://api.inaturalist.org/v1/observations?place_id=${placeId}&taxon_id=${speciesId}&verifiable=true&order=desc&order_by=created_at&per_page=5`);
                    const obsData = await obsResponse.json();
                    
                    displayRelatedObservations(obsData.results);
                }
            } catch (error) {
                console.error('Error cargando observaciones relacionadas:', error);
                document.getElementById('relatedObservations').innerHTML = '<p>Error cargando observaciones relacionadas.</p>';
            }
        }

        // Mostrar observaciones relacionadas
        function displayRelatedObservations(observations) {
            const container = document.getElementById('relatedObservations');
            
            if (!observations || observations.length === 0) {
                container.innerHTML = '<p>No hay observaciones recientes de esta especie.</p>';
                return;
            }
            
            let html = '<div class="list-group">';
            
            observations.forEach(observation => {
                const imageUrl = observation.photos && observation.photos.length > 0 ? 
                    observation.photos[0].url.replace('square', 'small') : 
                    'https://via.placeholder.com/50x50?text=Imagen+no+disponible';
                const observedDate = new Date(observation.observed_on).toLocaleDateString('es-ES');
                const observer = observation.user ? observation.user.login : 'Anónimo';
                const location = observation.place_guess || 'Ubicación no especificada';
                
                html += `
                    <div class="list-group-item">
                        <div class="d-flex align-items-center">
                            <img src="${imageUrl}" class="rounded me-3" width="50" height="50" alt="Observación">
                            <div class="flex-grow-1">
                                <div class="d-flex justify-content-between">
                                    <small class="text-muted">${observedDate}</small>
                                    <small class="text-muted">${observer}</small>
                                </div>
                                <p class="mb-1">${location}</p>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            container.innerHTML = html;
        }

        // Realizar búsqueda
        async function performSearch() {
            const query = document.getElementById('searchInput').value.trim();
            
            if (!query) {
                alert('Por favor, ingresa un término de búsqueda');
                return;
            }
            
            try {
                // Mostrar indicador de carga
                document.getElementById('featuredSpecies').innerHTML = `
                    <div class="col-12 text-center">
                        <div class="loading-spinner">
                            <div class="spinner-border text-primary" role="status">
                                <span class="visually-hidden">Buscando...</span>
                            </div>
                        </div>
                    </div>
                `;
                
                const response = await fetch('https://api.inaturalist.org/v1/places/autocomplete?q=valle%20del%20cauca');
                const data = await response.json();
                
                if (data.results && data.results.length > 0) {
                    const placeId = data.results[0].id;
                    
                    // Buscar especies que coincidan con la consulta en el Valle del Cauca
                    const searchResponse = await fetch(`https://api.inaturalist.org/v1/observations/species_counts?place_id=${placeId}&q=${encodeURIComponent(query)}&verifiable=true&per_page=${resultsPerPage}`);
                    const searchData = await searchResponse.json();
                    
                    displayFeaturedSpecies(searchData.results);
                    
                    // También buscar observaciones recientes que coincidan
                    const obsResponse = await fetch(`https://api.inaturalist.org/v1/observations?place_id=${placeId}&q=${encodeURIComponent(query)}&verifiable=true&order=desc&order_by=created_at&per_page=${resultsPerPage}`);
                    const obsData = await obsResponse.json();
                    
                    displayRecentObservations(obsData.results);
                    updateMapWithObservations(obsData.results);
                    
                    // Desplazarse a la sección de especies
                    document.getElementById('especies').scrollIntoView({ behavior: 'smooth' });
                }
            } catch (error) {
                console.error('Error en la búsqueda:', error);
                alert('Error al realizar la búsqueda. Por favor, intenta nuevamente.');
            }
        }

        // Buscar por categoría
        async function searchByCategory(category) {
            try {
                // Mostrar indicador de carga
                document.getElementById('featuredSpecies').innerHTML = `
                    <div class="col-12 text-center">
                        <div class="loading-spinner">
                            <div class="spinner-border text-primary" role="status">
                                <span class="visually-hidden">Buscando...</span>
                            </div>
                        </div>
                    </div>
                `;
                
                const response = await fetch('https://api.inaturalist.org/v1/places/autocomplete?q=valle%20del%20cauca');
                const data = await response.json();
                
                if (data.results && data.results.length > 0) {
                    const placeId = data.results[0].id;
                    
                    // Buscar especies por categoría taxonómica en el Valle del Cauca
                    let taxonId;
                    switch(category) {
                        case 'mammal': taxonId = 40151; break; // Mammalia
                        case 'bird': taxonId = 3; break; // Aves
                        case 'reptile': taxonId = 26036; break; // Reptilia
                        case 'amphibian': taxonId = 20978; break; // Amphibia
                        case 'insect': taxonId = 47158; break; // Insecta
                        case 'plant': taxonId = 47126; break; // Plantae
                        default: taxonId = null;
                    }
                    
                    if (taxonId) {
                        const searchResponse = await fetch(`https://api.inaturalist.org/v1/observations/species_counts?place_id=${placeId}&taxon_id=${taxonId}&verifiable=true&per_page=${resultsPerPage}`);
                        const searchData = await searchResponse.json();
                        
                        displayFeaturedSpecies(searchData.results);
                        
                        // También buscar observaciones recientes de esta categoría
                        const obsResponse = await fetch(`https://api.inaturalist.org/v1/observations?place_id=${placeId}&taxon_id=${taxonId}&verifiable=true&order=desc&order_by=created_at&per_page=${resultsPerPage}`);
                        const obsData = await obsResponse.json();
                        
                        displayRecentObservations(obsData.results);
                        updateMapWithObservations(obsData.results);
                        
                        // Desplazarse a la sección de especies
                        document.getElementById('especies').scrollIntoView({ behavior: 'smooth' });
                    }
                }
            } catch (error) {
                console.error('Error en la búsqueda por categoría:', error);
                alert('Error al realizar la búsqueda. Por favor, intenta nuevamente.');
            }
        }

        // Aplicar filtros al mapa
        function applyFilters() {
            const category = document.getElementById('categoryFilter').value;
            const startDate = document.getElementById('startDate').value;
            const endDate = document.getElementById('endDate').value;
            
            // Filtrar especies en la vista
            document.querySelectorAll('.species-card, .observation-card').forEach(card => {
                let show = true;
                
                // Filtrar por categoría
                if (category !== 'all' && card.getAttribute('data-category') !== category) {
                    show = false;
                }
                
                // Filtrar por fecha (para observaciones)
                if (card.classList.contains('observation-card')) {
                    const observationDate = card.querySelector('.fa-calendar-alt').parentElement.textContent.trim();
                    // En una implementación real, aquí se compararían las fechas
                }
                
                card.style.display = show ? 'block' : 'none';
            });
            
            // En una implementación real, aquí se recargarían los datos del mapa con los filtros aplicados
            // Por ahora, solo mostramos un mensaje
            console.log('Filtros aplicados:', { category, startDate, endDate });
        }

        // Actualizar datos del mapa
        function refreshMapData() {
            loadRecentObservations();
        }

        // Descargar datos
        function downloadData() {
            // En una implementación real, esto generaría un archivo con los datos
            alert('Función de descarga de datos habilitada. En una implementación real, se generarían archivos CSV o JSON con los datos filtrados.');
        }

        // Funciones auxiliares para categorías e iconos
        function getIconForTaxon(taxon) {
            if (!taxon || !taxon.ancestors) return 'fas fa-paw';
            
            const rank = taxon.rank;
            const ancestorIds = taxon.ancestor_ids;
            
            if (ancestorIds.includes(40151)) return 'fas fa-paw'; // Mamíferos
            if (ancestorIds.includes(3)) return 'fas fa-dove'; // Aves
            if (ancestorIds.includes(26036)) return 'fas fa-staff-snake'; // Reptiles
            if (ancestorIds.includes(20978)) return 'fas fa-frog'; // Anfibios
            if (ancestorIds.includes(47158)) return 'fas fa-bug'; // Insectos
            if (ancestorIds.includes(47178)) return 'fas fa-fish'; // Peces
            if (ancestorIds.includes(47126)) return 'fas fa-seedling'; // Plantas
            if (ancestorIds.includes(47170)) return 'fas fa-mushroom'; // Hongos
            
            return 'fas fa-paw';
        }

        function getCategoryClass(taxon) {
            if (!taxon || !taxon.ancestors) return 'other';
            
            const ancestorIds = taxon.ancestor_ids;
            
            if (ancestorIds.includes(40151)) return 'mammal';
            if (ancestorIds.includes(3)) return 'bird';
            if (ancestorIds.includes(26036)) return 'reptile';
            if (ancestorIds.includes(20978)) return 'amphibian';
            if (ancestorIds.includes(47158)) return 'insect';
            if (ancestorIds.includes(47178)) return 'fish';
            if (ancestorIds.includes(47126)) return 'plant';
            if (ancestorIds.includes(47170)) return 'fungi';
            
            return 'other';
        }

        function getCategoryName(taxon) {
            if (!taxon || !taxon.ancestors) return 'Otro';
            
            const ancestorIds = taxon.ancestor_ids;
            
            if (ancestorIds.includes(40151)) return 'Mamífero';
            if (ancestorIds.includes(3)) return 'Ave';
            if (ancestorIds.includes(26036)) return 'Reptil';
            if (ancestorIds.includes(20978)) return 'Anfibio';
            if (ancestorIds.includes(47158)) return 'Insecto';
            if (ancestorIds.includes(47178)) return 'Pez';
            if (ancestorIds.includes(47126)) return 'Planta';
            if (ancestorIds.includes(47170)) return 'Hongo';
            
            return 'Otro';
        }
    </script>
</body>
</html>